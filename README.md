# ğŸ”„ EchoTrace: Habit Echo Simulator

**Privacy-first browser habit tracker for Chrome (Manifest V3)**

Track your browser time locally, see engaging statistics, and get AI-powered future projections about your digital habits. 100% local. No data leaves your device.

## ğŸŒŸ Features

### MVP Included
- âœ… **Opt-in Tracking**: Toggle tracking on/off with a clear privacy notice always visible
- âœ… **Domain Categorization**: Automatic categorization into Social, News, Productivity, Entertainment, and Other
- âœ… **Smart Time Detection**: 
  - Uses `chrome.tabs` API for active tab tracking
  - `chrome.idle` detects away periods (>5min = pause tracking)
  - `chrome.history` supplements with historical visit analysis
- âœ… **Beautiful Dashboard**: Custom new tab override with:
  - Real-time pie chart (category breakdown)
  - Weekly bar chart trends
  - Top sites list
  - "Future Echo" projections (90-day outlook)
  - Daily/weekly totals and tips
- âœ… **Popup Widget**: Quick glance at today's stats + toggle + reset button
- âœ… **Data Export**: Download all your stats as JSON
- âœ… **Dark Mode**: Auto-detects system preference with `prefers-color-scheme`
- âœ… **100% Privacy**: All data in `chrome.storage.local`, no servers, no telemetry

### Future "Echo" Features (Roadmap)
- ğŸš€ ML-powered predictions using [Transformers.js](https://xenova.github.io/transformers.js/) for weekly forecasts
- ğŸ¯ Weekly goals & smart nudges
- ğŸ”” Browser habit insights (most productive hours, etc.)
- ğŸ“± Mobile sync (via private Firebase or P2P sync)
- ğŸ¨ Customizable category aliases
- â±ï¸ Pomodoro timer integration
- ğŸŒ Website blocker during focus mode

## ğŸ“‹ Installation

### Quick Start (Linux/Mac/Windows with WSL)

```bash
# Clone into Codespaces or your machine
cd /workspaces/echo-trace

# Run setup to convert SVG icons to PNG
bash setup.sh

# Or manually (if set up.sh fails):
# Ensure ImageMagick is installed, then:
sudo apt-get install -y imagemagick
convert -background none icons/icon16.svg -resize 16x16 icons/icon16.png
convert -background none icons/icon48.svg -resize 48x48 icons/icon48.png
convert -background none icons/icon128.svg -resize 128x128 icons/icon128.png
```

### Load in Chrome

1. Open Chrome and go to **chrome://extensions/**
2. Enable **Developer mode** (top-right toggle)
3. Click **"Load unpacked"**
4. Select the `/workspaces/echo-trace` folder
5. âœ… Done! You should see the EchoTrace icon in your toolbar

### First Time Use

1. **Click the EchoTrace icon** to open the popup
2. **Toggle "Enable Tracking"** to start
3. **Browse the web** for a few minutes
4. **Open a new tab** to see the dashboard
5. **Wait 5-10 minutes** for the background service worker to process stats

## ğŸ® How to Test

### Test Tracking
```
1. Enable tracking
2. Visit social sites (twitter.com, reddit.com, etc.)
3. Visit news sites (cnn.com, bbc.com)
4. Visit productivity sites (github.com, notion.so)
5. Open new tab â†’ see pie chart update in real-time
```

### Test Future Echo
```
1. Spend significant time on social media (30+ mins)
2. Open dashboard
3. Scroll to "Your Future Echo" section
4. Should show warning about lost focus hours in 90 days
```

### Test Idle Detection
```
1. Open a tab on a website
2. Let it sit idle for 5+ minutes (no activity)
3. Check: idle should pause time accumulation
4. Move mouse â†’ tracking resumes
```

### Test Data Export
```
1. Click dashboard "Export JSON" button
2. Opens a `.json` file with all stats
3. Can be imported into analysis tools
```

## ğŸ“Š Project Structure

```
echo-trace/
â”œâ”€â”€ manifest.json          # Manifest V3 configuration
â”œâ”€â”€ background.js          # Service worker (tracking logic)
â”œâ”€â”€ newtab.html           # Dashboard UI
â”œâ”€â”€ newtab.js             # Dashboard logic & Chart.js rendering
â”œâ”€â”€ newtab.css            # Dashboard styles (dark mode enabled)
â”œâ”€â”€ popup.html            # Popup widget UI
â”œâ”€â”€ popup.js              # Popup logic
â”œâ”€â”€ popup.css             # Popup styles
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon16.svg        # Source SVG (16x16)
â”‚   â”œâ”€â”€ icon16.png        # Chrome icon (auto-generated by setup.sh)
â”‚   â”œâ”€â”€ icon48.svg        # Source SVG (48x48)
â”‚   â”œâ”€â”€ icon48.png        # Chrome icon (auto-generated)
â”‚   â”œâ”€â”€ icon128.svg       # Source SVG (128x128)
â”‚   â””â”€â”€ icon128.png       # Chrome icon (auto-generated)
â”œâ”€â”€ setup.sh              # Setup script (SVG â†’ PNG conversion)
â””â”€â”€ README.md             # This file
```

## ğŸ” Privacy & Security

**100% Local Storage. Your data never leaves your device.**

- âœ… All tracking data stored in **`chrome.storage.local`**
- âœ… No external API calls (Chart.js loaded from CDN for perf, but no telemetry)
- âœ… No content scripts injected on websites
- âœ… No background network requests
- âœ… You can view/export all data anytime
- âœ… You can delete all data with one click
- âœ… Privacy notice visible on every page

**Permissions Required** (and why):
- `storage` â€” Save stats locally
- `tabs` â€” Monitor active tab
- `history` â€” Historical visit analysis (optional future feature)
- `idle` â€” Detect AFK periods
- `alarms` â€” Periodic background updates

## ğŸ¨ Customization

### Change Category Colors
Edit `newtab.css` CSS variables:
```css
:root {
  --primary-color: #45B7D1;  /* Main color */
  --accent-color: #FF6B6B;   /* Accent */
  /* ... */
}
```

### Add Custom Categories
Edit `background.js` `DOMAIN_CATEGORIES`:
```javascript
const DOMAIN_CATEGORIES = {
  social: ['twitter.com', 'instagram.com', /* ... */],
  newsAI: ['openai.com', 'anthropic.com'],  // Add custom category
  // ...
};
```

### Adjust Idle Detection
Edit `background.js` service worker:
```javascript
// Currently: 5 minutes idle = pause tracking
// To change: Edit chrome.idle.setDetectionInterval() if needed
```

### Adjust Alarm Frequency
Edit `manifest.json` or `background.js`:
```javascript
await chrome.alarms.create('processStats', { periodInMinutes: 5 }); // Change to 10, 15, etc.
```

## ğŸ“ˆ Future Projections Algorithm

The "Future Echo" feature uses simple rule-based calculations:

```javascript
// Example: Social media projection
if (socialDaily > 1h) {
  lostFocusHours = (socialDaily - 1) * 90 * 1.5  // Context-switching penalty
  projection = "In 90 days, lose ~300 focus hours"
}

// Overall balance
if (totalDaily < 4h) { status = "âœ¨ Great balance!" }
else if (totalDaily < 8h) { status = "ğŸ‘ Moderate" }
else { status = "âš ï¸ High screen time" }
```

### Future ML Upgrades
- Add Transformers.js sentiment analysis of visited sites
- Weekly forecasts with confidence intervals
- Habit change impact modeling

## ğŸ› ï¸ Development

### Adding New Features

1. **Service Worker (background.js)**
   - Add event listeners for new tracking
   - Update `addTimeToStats()` for new metrics

2. **Dashboard (newtab.js)**
   - Add new chart types via Chart.js
   - Add new stats cards

3. **Messaging**
   - To send data from service worker to pop/dashboard:
     ```javascript
     chrome.runtime.sendMessage({ action: 'getStats' }, (response) => { /* ... */ });
     ```

### Testing in Dev Mode

1. Edit code in your editor
2. Go to **chrome://extensions/**
3. Find EchoTrace, click the **â†» reload** button
4. Refresh newtab/popup to see changes

## ğŸ› Troubleshooting

| Issue | Solution |
|-------|----------|
| Icons not showing | Run `bash setup.sh` to generate PNGs from SVGs |
| Tracking not working | Make sure you enabled it + wait for alarm (5min) |
| Dashboard blank | Open browser DevTools (F12) â†’ check for errors |
| No new tab override | Verify manifest.json has `chrome_url_overrides.newtab` |
| Storage permission denied | Check manifest has `"storage"` permission |

## ğŸ“ License & Attribution

- **EchoTrace** Â© 2024 â€” MIT License
- **Chart.js** â€” MIT, loaded from CDN
- Icons by author (clock with echo ripple concept)

## ğŸ‘¨â€ğŸ’» Contributing

Ideas for improvement:
- Add more domain categories (health, learning, etc.)
- Improved future echo ML model
- Integrations with habit trackers (Toggl, RescueTime)
- Privacy report generation

## ğŸ“ Support

- **Issues?** Check chrome console (DevTools F12) for errors
- **Privacy concerns?** All code is localâ€”audit anytime
- **Feature requests?** Add to the "Future Echo Features" roadmap above

---

**Made with â¤ï¸ for conscious browsing. Your digital health matters.**

*"In 90 days, you could have 300 more focus-hours. Will that be you?"* ğŸš€